method find_last(a)
    requires a != null * lseg(next, a, null);
    ensures lseg(next, a, returned) * returned |-> null;
{
    n := a.next;
    if (n != null) {
        n2 := find_last(n);
        return n2;
    } else {
        return a;
    }
}

method rec_concat(a, b)
    requires a != null * lseg(next, a, null) * lseg(next, b, null);
    ensures lseg(next, a, b) * lseg(next, b, null);
{
    l := find_last(a);
    l.next := b;
}
