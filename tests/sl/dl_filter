method dl_filter(a, b)
    requires dlseg(a, null, null, b);
    ensures dlseg(a, null, null, b);
{
    prv := null;
    curr := a;
    while (curr != null) 
      invariant dlseg(a,null,curr,prv) * dlseg(curr,prv,null,b);
    { 
      old_curr := curr;
      curr := curr.next;
      if (Nondet) {
        if (prv != null) {
            prv.next := curr;
        } else {
            a := curr;
        }
        if (curr != null) {
            curr.back := prv;
        } else {
            b := prv;
        }
        free old_curr;
      } else {
        prv := old_curr;
      }
    }
}
