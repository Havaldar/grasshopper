method reverse(lst)
    requires lseg(next, lst, null);
    ensures lseg(next, returned, null);
{
    curr := lst;
    rev := null;
    while (curr != null) 
        invariant lseg(next, rev, null) * lseg(next, curr, null);
    {
        tmp := curr;
        curr := curr.next;
        tmp.next := rev;
        rev := tmp;
    }
    return rev;
}
