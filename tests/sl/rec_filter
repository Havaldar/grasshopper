method rec_filter(x)
    requires lseg(next, x, null);
    ensures lseg(next, returned, null);
{
    if (x == null) return x;
    else if (Random) {
        n1 := x.next;
        n2 := rec_filter(n1);
        x.next := n2;
        return x;
    } else {
        n1 := x.next;
        free x;
        n2 := rec_filter(n1);
        return n2;
    }
}
