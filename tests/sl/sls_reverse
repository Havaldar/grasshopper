method reverse(lst)
    requires slseg(next, data, lst, null);
    ensures rslseg(next, data, returned, null);
{
    curr := lst;
    rev := null;
    while (curr != null) 
        invariant (rev == null * slseg(next, data, curr, null)) || (rslseg(next, data, rev, null) * uslseg(next, data, curr, null, rev.data));
    {
        tmp := curr;
        curr := curr.next;
        tmp.next := rev;
        rev := tmp;
    }
    return rev;
}
