method dl_insert(lst, elt)
    requires dlseg(next, prev, a, null, null, b) * elt |-> null;
    ensures (a == null * dlseg(next, prev, elt, null, null, elt)) || dlseg(next, prev, a, null, null, b);
{
    if (a == null) {
        elt.prev := null;
        return elt;
    } else {
        curr := a;
        prv := null;
        while ( Random && curr.next != null ) 
            invariant curr != null * dlseg(next, prev, a, null, curr, prv) * dlseg(next, prev, curr, prv, null, b);
        {
            prv := curr;
            curr := curr.next;
        }
        elt.next := curr;
        curr.prev := elt;
        if (prv != null) {
          prv.next := elt;
        } else {
          a := elt;
        }
        elt.prev := prv;
        return a;
    }
}
